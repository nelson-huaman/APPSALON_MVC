{"version":3,"sources":["app.js"],"names":["paso","pasoInicial","pasoFinal","cita","id","nombre","fecha","hora","servicios","iniciarApp","mostrarSeccion","tabs","botonesPaginador","paginaSiguiente","paginaAnterior","consultarAPI","idCliente","nombreCliente","seleccionarFecha","seleccionarHora","mostrarResumen","seccionAnterior","document","querySelector","classList","remove","pasoSelector","add","tabAnterior","querySelectorAll","forEach","boton","addEventListener","event","parseInt","target","dataset","async","url","resultado","fetch","mostrarServicios","json","error","console","log","servicio","precio","nombreServicio","createElement","textContent","precioServicio","servicioDIV","idServicio","onclick","selecionarServicio","appendChild","divServicio","some","agregado","filter","value","dia","Date","getUTCDay","includes","mostrarAlerta","split","mensaje","tipo","elemento","desaparece","alertaPrevia","alerta","setTimeout","resumen","firstChild","removeChild","Object","values","length","headingServicios","contenedorServicio","textoServicio","innerHTML","headingCita","fechaObj","mes","getMonth","getDate","year","getFullYear","fechaFormateada","UTC","toLocaleDateString","weekday","month","day","fechaCliente","horaCliente","botonReservar","reservarCita","idServicios","map","datos","FormData","append","respuesta","method","body","Swal","fire","icon","title","text","button","then","window","location","reload"],"mappings":"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","file":"app.js","sourcesContent":["let paso = 1;\r\nconst pasoInicial = 1;\r\nconst pasoFinal = 3;\r\n\r\nconst cita = {\r\n    id: '',\r\n    nombre: '',\r\n    fecha: '',\r\n    hora: '',\r\n    servicios: []\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n    iniciarApp();\r\n});\r\n\r\nfunction iniciarApp() {\r\n    mostrarSeccion(); // Muestra y Oculta Secciones\r\n    tabs(); // Cambia la Seccion cunado se preciona los tab\r\n    botonesPaginador(); //Agrega o quita los botones del Paginador\r\n    paginaSiguiente();\r\n    paginaAnterior();\r\n\r\n    consultarAPI(); // Consultar API\r\n\r\n    idCliente();\r\n    nombreCliente(); // Añade el nombre del cleinte al obteto de la Cita\r\n    seleccionarFecha(); // Añade la fecha de la cita en el Objeto\r\n    seleccionarHora(); // Añade la Hora de la cita en el Objeto\r\n\r\n    mostrarResumen();\r\n}\r\n\r\nfunction mostrarSeccion() {\r\n    // Ocultar\r\n    const seccionAnterior = document.querySelector('.mostrar');\r\n    if (seccionAnterior) {\r\n        seccionAnterior.classList.remove('mostrar');\r\n    }\r\n\r\n    // Mostrar\r\n    const pasoSelector = `#paso-${paso}`;\r\n    const seccion = document.querySelector(pasoSelector);\r\n    seccion.classList.add('mostrar');\r\n\r\n    // Resaltar quitar\r\n    const tabAnterior = document.querySelector('.actual');\r\n    if (tabAnterior) {\r\n        tabAnterior.classList.remove('actual');\r\n    }\r\n\r\n    // Resaltar\r\n    const tab = document.querySelector(`[data-paso=\"${paso}\"]`);\r\n    tab.classList.add('actual');\r\n}\r\n\r\nfunction tabs() {\r\n    const botones = document.querySelectorAll('.tabs button');\r\n    \r\n    botones.forEach( boton => {\r\n        boton.addEventListener('click', function(event) {\r\n            paso = parseInt( event.target.dataset.paso);\r\n            mostrarSeccion();\r\n            botonesPaginador();\r\n        });\r\n    })\r\n}\r\n\r\nfunction botonesPaginador() {\r\n    const paginaAnterior = document.querySelector('#anterior');\r\n    const paginaSiguiente = document.querySelector('#siguiente');\r\n\r\n    if (paso === 1) {\r\n        paginaAnterior.classList.add('ocultar');\r\n        paginaSiguiente.classList.remove('ocultar');\r\n    } else if (paso === 3) {\r\n        paginaAnterior.classList.remove('ocultar');\r\n        paginaSiguiente.classList.add('ocultar');\r\n        mostrarResumen();\r\n    } else {\r\n        paginaAnterior.classList.remove('ocultar');\r\n        paginaSiguiente.classList.remove('ocultar');\r\n    }\r\n\r\n    mostrarSeccion()\r\n}\r\n\r\nfunction paginaAnterior() {\r\n    const paginaAnterior = document.querySelector('#anterior');\r\n    paginaAnterior.addEventListener('click', function() {\r\n        if (paso <= pasoInicial) return;\r\n        paso--;\r\n        botonesPaginador();\r\n    })\r\n}\r\n\r\nfunction paginaSiguiente() {\r\n    const paginaSiguiente = document.querySelector('#siguiente');\r\n    paginaSiguiente.addEventListener('click', function() {\r\n        if (paso >= pasoFinal) return;\r\n        paso++;\r\n        botonesPaginador();\r\n    })\r\n}\r\n\r\nasync function consultarAPI() {\r\n    try {\r\n        const url = 'http://localhost:3000/api/servicios';\r\n        const resultado = await fetch(url);\r\n        const servicios = await resultado.json();\r\n        mostrarServicios(servicios);\r\n        \r\n    } catch (error) {\r\n        console.log(error);\r\n    }\r\n}\r\n\r\nfunction mostrarServicios(servicios) {\r\n    servicios.forEach( servicio => {\r\n        const {id, nombre, precio} = servicio;\r\n\r\n        const nombreServicio = document.createElement('P');\r\n        nombreServicio.classList.add('nombre-servicio');\r\n        nombreServicio.textContent = nombre;\r\n\r\n        const precioServicio = document.createElement('P');\r\n        precioServicio.classList.add('precio-servicio');\r\n        precioServicio.textContent = `S/. ${precio}`;\r\n\r\n        const servicioDIV = document.createElement('DIV');\r\n        servicioDIV.classList.add('servicio');\r\n        servicioDIV.dataset.idServicio = id;\r\n        servicioDIV.onclick = function() {\r\n            selecionarServicio(servicio);\r\n        }\r\n\r\n        servicioDIV.appendChild(nombreServicio);\r\n        servicioDIV.appendChild(precioServicio);\r\n\r\n        document.querySelector('#servioios').appendChild(servicioDIV);\r\n    });\r\n}\r\n\r\nfunction selecionarServicio(servicio) {\r\n    const {id} = servicio;\r\n    const {servicios} = cita;\r\n\r\n    // Identificar el Elemento\r\n    const divServicio = document.querySelector(`[data-id-servicio=\"${id}\"]`);\r\n\r\n    // Comprovar si fue agregado\r\n    if ( servicios.some(agregado => agregado.id === id )) {\r\n        cita.servicios = servicios.filter( agregado => agregado.id !== id);\r\n        divServicio.classList.remove('seleccionado');\r\n    } else {\r\n        cita.servicios = [...servicios, servicio];\r\n        divServicio.classList.add('seleccionado');\r\n    }\r\n    //console.log(cita);\r\n}\r\n\r\nfunction idCliente() {\r\n    cita.id = document.querySelector('#id').value; \r\n}\r\n\r\nfunction nombreCliente() {\r\n    cita.nombre = document.querySelector('#nombre').value; \r\n}\r\n\r\nfunction seleccionarFecha() {\r\n    const inputFecha = document.querySelector('#fecha');\r\n    inputFecha.addEventListener('input', function(event) {\r\n\r\n        const dia = new Date(event.target.value).getUTCDay();\r\n\r\n        if ( [6, 0].includes(dia) ) {\r\n            event.target.value = '';\r\n            mostrarAlerta('Fines de semana no atendemos', 'error', '.formulario');\r\n        } else {\r\n            cita.fecha = event.target.value;\r\n        }\r\n    });\r\n}\r\n\r\nfunction seleccionarHora() {\r\n    const inputHora = document.querySelector('#hora');\r\n    inputHora.addEventListener('input', function(event) {\r\n\r\n        const horaCita = event.target.value;\r\n        const hora = horaCita.split(\":\")[0];\r\n        \r\n        if (hora < 10 || hora > 18) {\r\n            event.target.value = '';\r\n            mostrarAlerta('Hora no valida', 'error', '.formulario');\r\n        } else {\r\n            cita.hora = event.target.value;\r\n            //console.log(cita);\r\n        }\r\n    });\r\n    \r\n}\r\n\r\nfunction mostrarAlerta(mensaje, tipo, elemento, desaparece = true) {\r\n    const alertaPrevia = document.querySelector('.alerta');\r\n    if(alertaPrevia) {\r\n        alertaPrevia.remove();\r\n    }\r\n\r\n    const alerta = document.createElement('DIV');\r\n    alerta.textContent = mensaje;\r\n    alerta.classList.add('alerta');\r\n    alerta.classList.add(tipo);\r\n\r\n    const referencia = document.querySelector(elemento);\r\n    referencia.appendChild(alerta);\r\n\r\n    if (desaparece) {\r\n        setTimeout(() => {\r\n            alerta.remove();\r\n        }, 3000);\r\n    }\r\n}\r\n\r\nfunction mostrarResumen() {\r\n    const resumen = document.querySelector('.contenido-resumen');\r\n\r\n    // limpiar contenido\r\n    while ( resumen.firstChild ) {\r\n        resumen.removeChild(resumen.firstChild);\r\n    }\r\n\r\n     if ( Object.values(cita).includes('') || cita.servicios.length === 0 ) {\r\n        mostrarAlerta('Falta datos de Servicios, Fecha u Hora', 'error', '.contenido-resumen', false);\r\n        return\r\n    } \r\n\r\n    // Formatear el DIV resumen\r\n    const { nombre, fecha, hora, servicios } = cita;\r\n\r\n    // Heading para los Servicios en resumen\r\n    const headingServicios = document.createElement('H3');\r\n    headingServicios.textContent = 'Resumen de Servicios';\r\n    resumen.appendChild(headingServicios);\r\n\r\n    // Iterando y Mostrnado los Servicio\r\n    servicios.forEach(servicio => {\r\n        const { id, precio, nombre } = servicio;\r\n        const contenedorServicio = document.createElement('DIV');\r\n        contenedorServicio.classList.add('contenedor-servicio');\r\n\r\n        const textoServicio = document.createElement('P');\r\n        textoServicio.textContent = nombre;\r\n\r\n        const precioServicio = document.createElement('P');\r\n        precioServicio.innerHTML = `<span>Precio: </span> S/. ${precio}`;\r\n\r\n        contenedorServicio.appendChild(textoServicio);\r\n        contenedorServicio.appendChild(precioServicio);\r\n\r\n        resumen.appendChild(contenedorServicio);\r\n    })\r\n\r\n    // Heading para los Servicios en resumen\r\n    const headingCita = document.createElement('H3');\r\n    headingCita.textContent = 'Resumen de Cita';\r\n    resumen.appendChild(headingCita);\r\n\r\n    const nombreCliente = document.createElement('P');\r\n    nombreCliente.innerHTML = `<span>Nombre: </span> ${nombre}`;\r\n\r\n    // Formate la fecha en Español\r\n    const fechaObj = new Date(fecha);\r\n    const mes = fechaObj.getMonth();\r\n    const dia = fechaObj.getDate() + 2;\r\n    const year = fechaObj.getFullYear();\r\n\r\n    const fechaUTC = new Date(Date.UTC(year, mes, dia));\r\n\r\n    const opciones = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };\r\n    const fechaFormateada = fechaUTC.toLocaleDateString('es-ES', opciones);\r\n\r\n    const fechaCliente = document.createElement('P');\r\n    fechaCliente.innerHTML = `<span>Nombre: </span> ${fechaFormateada}`;\r\n\r\n    const horaCliente = document.createElement('P');\r\n    horaCliente.innerHTML = `<span>Nombre: </span> ${hora} Horas`;\r\n\r\n    // Boton para crear la Cita\r\n    const botonReservar = document.createElement('BUTTON');\r\n    botonReservar.classList.add('boton');\r\n    botonReservar.textContent = 'Reservar Cita';\r\n    botonReservar.onclick = reservarCita;\r\n    \r\n    resumen.appendChild(nombreCliente);\r\n    resumen.appendChild(fechaCliente);\r\n    resumen.appendChild(horaCliente);\r\n\r\n    resumen.appendChild(botonReservar);\r\n}\r\n\r\nasync function reservarCita() {\r\n\r\n    const { nombre, fecha, hora, servicios, id } = cita;\r\n    const idServicios = servicios.map(servicio => servicio.id);\r\n\r\n    const datos = new FormData();\r\n\r\n    datos.append('fecha', fecha);\r\n    datos.append('hora', hora);\r\n    datos.append('usuarioId', id);\r\n    datos.append('servicios', idServicios);\r\n\r\n    try {\r\n        // Petición hacia la API\r\n        const url = 'http://localhost:3000/api/citas';\r\n        const respuesta = await fetch(url, {\r\n            method: 'POST',\r\n            body: datos\r\n        });\r\n\r\n        const resultado = await respuesta.json();\r\n\r\n        console.log(resultado.resultado);\r\n\r\n        if (resultado.resultado) {\r\n            Swal.fire({\r\n                icon: 'success',\r\n                title: 'Cita Creada',\r\n                text: 'Tu Cita fue Creada Correctamente',\r\n                button: 'Ok'\r\n            }).then ( () => {\r\n                setTimeout(() => {\r\n                    window.location.reload();               \r\n                }, 3000);                \r\n            })\r\n        }\r\n        \r\n    } catch (error) {\r\n        Swal.fire({\r\n            icon: 'error',\r\n            title: 'Error',\r\n            text: 'Hubo un error al guardar la Cita'\r\n        })\r\n    }\r\n\r\n    \r\n}"]}